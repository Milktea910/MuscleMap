import{a9 as M,r as q,o as I,aa as g,ab as o,ac as c,ae as O,ag as t,f as r,ai as i,as as z,at as D,an as m,F as u,aj as v,ak as a,ao as h,al as _,av as A,ah as V,aw as W,ax as G}from"./index-Bn42XH2Q.js";import{Q as B}from"./QChip-4Dk9RzM6.js";import{Q as H,a as J,b as K,c as X}from"./QTabPanels-DyHw-Y6y.js";import{Q as Y}from"./QPage-CE1UNi1s.js";import{u as Z}from"./use-quasar-B9tJROjq.js";import{r as $}from"./routine-CuuvH8Q_.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./touch-CjDUbXLY.js";import"./rtl-DFPa-2ov.js";import"./selection-CqqBGjGe.js";import"./use-render-cache-DLxPkVnQ.js";const ee={class:"container fade-in-up"},te={key:1,class:"row q-col-gutter-lg"},se={class:"row items-center justify-between q-mb-sm"},oe={class:"text-h6 routine-title"},ie={class:"text-body2 text-grey-7 routine-description"},le={class:"q-mt-md routine-workouts"},ae={key:0},ne={class:"weekly-plan"},re={class:"day-header text-weight-medium text-primary q-mb-xs"},de={key:0},ce={key:0,class:"rest-day text-grey-6 q-ml-md"},me={key:1,class:"workout-list q-ml-md"},ue={key:2,class:"no-workouts text-grey-6 q-ml-md"},ve={key:3,class:"day-notes text-caption text-grey-6 q-ml-md q-mt-xs"},_e={key:1},xe={class:"workout-list"},ye={key:2,class:"text-caption text-grey-6"},ge={class:"text-caption text-grey-6"},ke={class:"row items-center justify-between"},he={class:"text-h6"},pe={class:"q-mb-md"},fe={class:"row items-center q-mb-sm"},qe={class:"text-caption text-grey-6"},we={class:"text-body1 q-mb-md"},be={class:"routine-detail-content"},Ce={key:0},Qe={class:"day-detail"},De={class:"text-h6 q-mb-sm"},Ve={key:0},Re={key:0,class:"rest-day-detail q-pa-md text-center"},ze={key:0,class:"text-body2 text-grey-6 q-mt-sm"},Le={key:1},Se={class:"row items-center q-mb-sm"},Te=["onClick"],Ne={key:1,class:"text-h6 text-grey-6"},Ae={class:"workout-stats row q-col-gutter-lg"},Be={class:"col"},$e={class:"text-h6"},je={class:"col"},Ue={class:"text-h6"},Ee={class:"col"},Fe={class:"text-h6"},Me={key:0,class:"day-notes-detail q-pa-md q-mt-md"},Ie={class:"text-subtitle2 q-mb-sm"},Oe={class:"text-body2"},We={key:2,class:"no-workouts-detail q-pa-md text-center"},Ge={key:1},He={class:"row items-center q-mb-sm"},Je=["onClick"],Ke={key:1,class:"text-h6 text-grey-6"},Xe={class:"workout-stats row q-col-gutter-lg"},Ye={class:"col"},Ze={class:"text-h6"},Pe={class:"col"},et={class:"text-h6"},tt={class:"col"},st={class:"text-h6"},ot={key:2,class:"no-content-detail q-pa-md text-center"},it={__name:"RoutinesPage",setup(lt){const p=Z(),j=O(),f=M(),w=q([]),b=q(null),C=q(!1),d=q(null),x=q(0),U=async()=>{try{const{data:n}=await $.getPublicRoutines();w.value=n.data}catch(n){console.error("載入公開課表失敗:",n),p.notify({color:"red-5",textColor:"white",icon:"warning",message:"載入公開課表失敗"})}},Q=n=>!f.isLoggedIn||!n.likes||!Array.isArray(n.likes)?!1:n.likes.some(s=>String(s)===String(f._id)),L=async n=>{if(!f.isLoggedIn){p.notify({color:"orange-5",textColor:"white",icon:"warning",message:"請先登入才能按讚"});return}try{b.value=n;const{data:s}=await $.toggleLike(n),e=w.value.find(l=>l._id===n);if(e){if(e.likesCount=s.data.likesCount,s.data.liked)e.likes||(e.likes=[]),e.likes.push(f._id);else if(e.likes){const l=e.likes.indexOf(f._id);l>-1&&e.likes.splice(l,1)}}p.notify({color:"positive",textColor:"white",icon:"favorite",message:s.message})}catch(s){console.error("按讚失敗:",s),p.notify({color:"red-5",textColor:"white",icon:"warning",message:"按讚失敗"})}finally{b.value=null}},S=n=>new Date(n).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}),E=n=>{d.value=n,n.weeklyPlan&&n.weeklyPlan.length>0?x.value=n.weeklyPlan[0].day:x.value=0,C.value=!0},T=(n,s,e)=>{if(e&&e.stopPropagation(),!n){p.notify({color:"orange-5",textColor:"white",icon:"warning",message:"動作資訊不完整"});return}R(),j.push({path:"/muscle-exercises",query:{exerciseId:n,exerciseName:s}})},R=()=>{C.value=!1,d.value=null,x.value=0},N=n=>["星期一","星期二","星期三","星期四","星期五","星期六","星期日"][n]||`第${n+1}天`;return I(async()=>{await U()}),(n,s)=>(o(),g(Y,{class:"q-pa-md"},{default:c(()=>[t("div",ee,[s[7]||(s[7]=t("div",{class:"q-mb-xl"},[t("h1",{class:"section text-h4 q-mt-xl text-center"},"推薦課表"),t("p",{class:"section-description text-center"}," 在這裡，您可以找到各種公開的健身課表，這些課表由社群用戶分享，涵蓋不同的訓練目標和風格。無論您是初學者還是有經驗的健身愛好者，都能找到適合自己的課表。 ")],-1)),t("div",null,[w.value.length===0?(o(),g(z,{key:0,class:"text-center q-pa-lg"},{default:c(()=>[r(D,null,{default:c(()=>[r(m,{name:"fitness_center",size:"4rem",color:"grey-5"}),s[4]||(s[4]=t("div",{class:"text-h6 q-mt-md text-grey-6"},"目前還沒有公開的課表",-1))]),_:1,__:[4]})]),_:1})):(o(),i("div",te,[(o(!0),i(u,null,v(w.value,e=>(o(),i("div",{key:e._id,class:"col-12 col-md-6 col-lg-4"},[r(z,{class:"routine-card cursor-pointer",onClick:l=>E(e)},{default:c(()=>[r(D,{class:"routine-card-content"},{default:c(()=>[t("div",se,[t("div",oe,a(e.title),1),r(B,{color:"primary","text-color":"white",size:"md"},{default:c(()=>[h(a(e.user?.username||"匿名用戶"),1)]),_:2},1024)]),t("div",ie,a(e.content),1),t("div",le,[e.weeklyPlan&&e.weeklyPlan.length>0?(o(),i("div",ae,[s[5]||(s[5]=t("div",{class:"text-subtitle2 q-mb-sm"},"週計劃內容：",-1)),t("div",ne,[(o(!0),i(u,null,v(e.weeklyPlan,(l,y)=>(o(),i("div",{key:y,class:"day-plan q-mb-sm"},[t("div",re,[l.name&&l.name!==N(l.day)?(o(),i("span",de,a(l.name),1)):_("",!0)]),l.isRestDay?(o(),i("div",ce," 🛌 休息日 ")):l.workouts&&l.workouts.length>0?(o(),i("div",me,[(o(!0),i(u,null,v(l.workouts,(k,F)=>(o(),i("div",{key:F,class:"workout-item text-body2"},a(k.exercise?.name)+" - "+a(k.sets)+"組 x "+a(k.reps)+"次 (休息 "+a(k.rest)+"秒) ",1))),128))])):(o(),i("div",ue,"尚未安排訓練")),l.notes?(o(),i("div",ve," 📝 "+a(l.notes),1)):_("",!0)]))),128))])])):e.workouts&&e.workouts.length>0?(o(),i("div",_e,[s[6]||(s[6]=t("div",{class:"text-subtitle2 q-mb-sm"},"動作內容：",-1)),t("div",xe,[(o(!0),i(u,null,v(e.workouts,(l,y)=>(o(),i("div",{key:y,class:"workout-item text-body2"},a(l.exercise?.name)+" - "+a(l.sets)+"組 x "+a(l.reps)+"次 (休息 "+a(l.rest)+"秒) ",1))),128))])])):(o(),i("div",ye,"此課表尚未設定訓練內容"))])]),_:2},1024),r(A,{class:"justify-between"},{default:c(()=>[r(V,{color:Q(e)?"red":"grey",icon:Q(e)?"favorite":"favorite_border",flat:"",onClick:W(l=>L(e._id),["stop"]),loading:b.value===e._id},{default:c(()=>[h(a(e.likesCount||0),1)]),_:2},1032,["color","icon","onClick","loading"]),t("div",ge,a(S(e.createdAt)),1)]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))])]),r(G,{modelValue:C.value,"onUpdate:modelValue":s[3]||(s[3]=e=>C.value=e),position:"top"},{default:c(()=>[r(z,{class:"routine-detail-dialog"},{default:c(()=>[d.value?(o(),g(D,{key:0},{default:c(()=>[t("div",ke,[t("div",he,a(d.value.title),1),r(V,{icon:"close",flat:"",round:"",dense:"",onClick:R})])]),_:1})):_("",!0),d.value?(o(),g(D,{key:1,class:"q-pt-none",style:{"max-height":"60vh","overflow-y":"auto"}},{default:c(()=>[t("div",pe,[t("div",fe,[r(B,{color:"primary","text-color":"white",size:"md",class:"q-mr-sm"},{default:c(()=>[h(a(d.value.user?.username||"匿名用戶"),1)]),_:1}),t("div",qe,a(S(d.value.createdAt)),1)]),t("div",we,a(d.value.content),1)]),t("div",be,[d.value.weeklyPlan&&d.value.weeklyPlan.length>0?(o(),i("div",Ce,[s[14]||(s[14]=t("div",{class:"text-h6 q-mb-md"},"週計劃詳細內容",-1)),r(H,{modelValue:x.value,"onUpdate:modelValue":s[0]||(s[0]=e=>x.value=e),class:"q-mb-md",align:"left"},{default:c(()=>[(o(!0),i(u,null,v(d.value.weeklyPlan,e=>(o(),g(J,{key:e.day,name:e.day,label:e.name},null,8,["name","label"]))),128))]),_:1},8,["modelValue"]),r(K,{modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=e=>x.value=e),animated:""},{default:c(()=>[(o(!0),i(u,null,v(d.value.weeklyPlan,e=>(o(),g(X,{key:e.day,name:e.day},{default:c(()=>[t("div",Qe,[t("div",De,[e.name&&e.name!==N(e.day)?(o(),i("span",Ve,a(e.name),1)):_("",!0)]),e.isRestDay?(o(),i("div",Re,[r(m,{name:"bed",size:"3rem",color:"grey-5"}),s[8]||(s[8]=t("div",{class:"text-h6 q-mt-md text-grey-6"},"休息日",-1)),e.notes?(o(),i("div",ze,a(e.notes),1)):_("",!0)])):e.workouts&&e.workouts.length>0?(o(),i("div",Le,[(o(!0),i(u,null,v(e.workouts,(l,y)=>(o(),i("div",{key:y,class:"workout-detail-item q-mb-md q-pa-md"},[t("div",Se,[r(m,{name:"fitness_center",color:"primary",class:"q-mr-sm"}),l.exercise?._id?(o(),i("div",{key:0,class:"text-h6 exercise-name-link cursor-pointer",onClick:k=>T(l.exercise._id,l.exercise.name,k)},[h(a(l.exercise.name)+" ",1),r(m,{name:"launch",size:"sm",class:"q-ml-xs"})],8,Te)):(o(),i("div",Ne,"未設定動作"))]),t("div",Ae,[t("div",Be,[s[9]||(s[9]=t("div",{class:"text-caption text-grey-6"},"組數",-1)),t("div",$e,a(l.sets),1)]),t("div",je,[s[10]||(s[10]=t("div",{class:"text-caption text-grey-6"},"次數",-1)),t("div",Ue,a(l.reps),1)]),t("div",Ee,[s[11]||(s[11]=t("div",{class:"text-caption text-grey-6"},"休息時間",-1)),t("div",Fe,a(l.rest)+"秒",1)])])]))),128)),e.notes?(o(),i("div",Me,[t("div",Ie,[r(m,{name:"note",class:"q-mr-sm"}),s[12]||(s[12]=h(" 備註 "))]),t("div",Oe,a(e.notes),1)])):_("",!0)])):(o(),i("div",We,[r(m,{name:"info",size:"2rem",color:"grey-5"}),s[13]||(s[13]=t("div",{class:"text-body1 q-mt-md text-grey-6"},"此日尚未安排訓練",-1))]))])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])):d.value.workouts&&d.value.workouts.length>0?(o(),i("div",Ge,[s[18]||(s[18]=t("div",{class:"text-h6 q-mb-md"},"動作詳細內容",-1)),(o(!0),i(u,null,v(d.value.workouts,(e,l)=>(o(),i("div",{key:l,class:"workout-detail-item q-mb-md q-pa-md"},[t("div",He,[r(m,{name:"fitness_center",color:"primary",class:"q-mr-sm"}),e.exercise?._id?(o(),i("div",{key:0,class:"text-h6 exercise-name-link cursor-pointer",onClick:y=>T(e.exercise._id,e.exercise.name,y)},[h(a(e.exercise.name)+" ",1),r(m,{name:"launch",size:"sm",class:"q-ml-xs"})],8,Je)):(o(),i("div",Ke,"未設定動作"))]),t("div",Xe,[t("div",Ye,[s[15]||(s[15]=t("div",{class:"text-caption text-grey-6"},"組數",-1)),t("div",Ze,a(e.sets),1)]),t("div",Pe,[s[16]||(s[16]=t("div",{class:"text-caption text-grey-6"},"次數",-1)),t("div",et,a(e.reps),1)]),t("div",tt,[s[17]||(s[17]=t("div",{class:"text-caption text-grey-6"},"休息時間",-1)),t("div",st,a(e.rest)+"秒",1)])])]))),128))])):(o(),i("div",ot,[r(m,{name:"info",size:"3rem",color:"grey-5"}),s[19]||(s[19]=t("div",{class:"text-h6 q-mt-md text-grey-6"},"此課表尚未設定訓練內容",-1))]))])]),_:1})):_("",!0),d.value?(o(),g(A,{key:2,align:"right"},{default:c(()=>[r(V,{color:Q(d.value)?"red":"grey",icon:Q(d.value)?"favorite":"favorite_border",label:d.value.likesCount||0,onClick:s[2]||(s[2]=e=>L(d.value._id)),loading:b.value===d.value._id},null,8,["color","icon","label","loading"]),r(V,{flat:"",label:"關閉",onClick:R})]),_:1})):_("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},gt=P(it,[["__scopeId","data-v-7edaea43"]]);export{gt as default};
