import{m as ie,aD as re,aE as ce,h as ne,a9 as ue,r as f,w as W,o as de,b as me,aa as _,ab as a,ac as r,ad as ge,ae as ve,ag as s,f as i,ai as c,an as G,F as w,aj as L,as as T,aF as he,au as fe,at as B,ak as u,ao as p,al as C,az as pe,aq as _e,ah as J,ax as ye,u as be,aC as xe}from"./index-Bn42XH2Q.js";import{Q as E}from"./QChip-4Dk9RzM6.js";import{Q as qe}from"./QTooltip-LorpOzhX.js";import{Q as Me,a as ke}from"./QToolbar-CecbVfQh.js";import{Q as we,a as K,b as Ce}from"./QItemLabel-CkehzaSt.js";import{Q as Qe}from"./QList-CU7fouqH.js";import{Q as Ee}from"./QPage-CE1UNi1s.js";import{C as Ae}from"./ClosePopup-Cem-9zu5.js";import{u as Ie}from"./use-quasar-B9tJROjq.js";import{M as X,a as Y}from"./MaleBack-CEgwATyd.js";import{F as Le,a as Ne}from"./FemaleBack-CozmKmUn.js";import{w as Ve}from"./wiki-BbAW4oNI.js";import{g as N,a as Se}from"./muscleMapping-CknbMQiE.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./position-engine-C9dRj_c-.js";import"./selection-CqqBGjGe.js";const De='<circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity=".3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from=".5" to=".5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',Fe=ie({name:"QSpinnerDots",props:re,setup(H){const{cSize:m,classes:S}=ce(H);return()=>ne("svg",{class:S.value,fill:"currentColor",width:m.value,height:m.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",innerHTML:De})}}),Te={class:"container fade-in-up"},Be={class:"row q-col-gutter-lg"},He={class:"col-12 col-lg-9"},Pe={key:0,class:"text-center q-pa-lg"},Ue={key:1,class:"text-center q-pa-lg"},$e={key:2,class:"exercise-list"},Re={class:"row no-wrap equal-height-row"},je={class:"col-12 col-md-5 flex"},Oe={class:"video-container"},We=["src"],Ge={key:1,class:"video-placeholder"},Je={class:"col-12 col-md-7 flex"},Ke={class:"text-h6 exercise-name"},Xe={class:"exercise-meta q-mt-sm"},Ye={class:"exercise-description q-mt-md"},Ze={class:"text-body2"},es={key:0,class:"q-mb-sm"},ss={key:1},ts={class:"notes-list"},ls={key:2,class:"q-mt-sm"},as={key:3},os={class:"col-12 col-lg-3"},is={class:"sticky-top"},rs={class:"text-center q-mb-md"},cs={class:"text-h6 text-center q-mb-md"},ns={key:0,class:"text-caption text-grey-6"},us={class:"flex flex-center"},ds={class:"text-center q-mt-md"},ms={class:"row q-col-gutter-lg"},gs={class:"col-12 col-md-8"},vs={key:0,class:"q-mb-lg"},hs=["src"],fs={class:"q-mb-md"},ps={class:"row q-col-gutter-lg justify-center"},_s={class:"col-6 col-sm-5 col-md-4"},ys={class:"muscle-diagram-container"},bs={class:"col-6 col-sm-5 col-md-4"},xs={class:"muscle-diagram-container"},qs={class:"col-12 col-md-4"},Ms={class:"q-mb-md"},ks={key:0},ws={class:"q-mb-md"},Cs={class:"q-mb-md"},Qs={key:0,class:"q-mb-md"},Es={__name:"MuscleExercisePage",setup(H){const m=ge(),S=ve(),P=Ie(),A=ue(),z=f(!0),D=f([]),x=f(""),y=f([]),v=f(!0),b=f([]),M=f("男生"),F=f(!1),n=f(null),Z=f(new Map),I=f(null),U=["斜方肌","背闊肌","菱形肌","豎脊肌","大腿後側肌群","肩後束","肱三頭肌","臀大肌"],$=()=>{A.isLoggedIn&&A.gender?M.value=A.gender==="male"?"男生":"女生":m.query.gender&&(M.value=m.query.gender)},ee=(l,e)=>{l&&(Z.value.set(e,l),I.value&&I.value.observe(l))},se=()=>{I.value=new IntersectionObserver(l=>{l.forEach(e=>{const t=e.target;e.isIntersecting&&e.intersectionRatio>.3?t.play().catch(()=>{}):t.pause()})},{threshold:.3,rootMargin:"50px"})},R=l=>l?l.startsWith("http://")||l.startsWith("https://")?l:`http://localhost:3000/${l.replace(/^\//,"")}`:"",te=l=>{n.value=l,F.value=!0},j=l=>l?Array.isArray(l)?l.flatMap(e=>N(e)||[]):N(l)||[]:[],le=l=>({啞鈴:"img:./assets/icons/dumbbell.svg",器械:"img:./assets/icons/barbell.svg",壺鈴:"img:./assets/icons/kettlebells.svg",繩索:"img:./assets/icons/cables.svg",槓片:"img:./assets/icons/Plate.svg",史密斯:"img:./assets/icons/smith machine.svg",槓鈴:"img:./assets/icons/barbell.svg",徒手:"img:./assets/icons/bodyweight.svg",藥球:"img:./assets/icons/medicine ball.svg",伸展:"img:./assets/icons/stretches.svg",彈力繩:"img:./assets/icons/band.svg",瑜伽:"img:./assets/icons/yoga.svg",恢復:"img:./assets/icons/recovery.svg",有氧:"img:./assets/icons/cardio.svg",全部:"img:./assets/icons/all.svg"})[l]||"fitness_center",ae=l=>({初級:"green",中級:"orange",高級:"red"})[l]||"grey";W(()=>[A.isLoggedIn,A.gender],()=>{$()},{immediate:!0});const O=async()=>{try{z.value=!0;const l=m.query.muscle,e=m.query.equipment,t=m.query.exerciseId,Q=m.query.exerciseName,k=(await Ve.getExercises()).data.exercises;let h=[];if(t){const o=k.find(d=>d._id===t);if(o){h=[o],Array.isArray(o.targetMuscle)&&o.targetMuscle.length>0?x.value=o.targetMuscle[0]:typeof o.targetMuscle=="string"?x.value=o.targetMuscle:x.value=Q||"指定動作";const d=Array.isArray(o.targetMuscle)?o.targetMuscle[0]:o.targetMuscle;d&&U.includes(d)?v.value=!1:v.value=!0,Array.isArray(o.targetMuscle)?b.value=o.targetMuscle.flatMap(g=>[g,...N(g)]):o.targetMuscle&&(b.value=[o.targetMuscle,...N(o.targetMuscle)]),setTimeout(()=>{const g=document.querySelector(`#exercise-${t}`);g&&g.scrollIntoView({behavior:"smooth",block:"start"})},100)}else{P.notify({color:"negative",message:"找不到指定的動作",icon:"error"});return}}else if(l){const o=Se(l);x.value=o,U.includes(o)?v.value=!1:v.value=!0,b.value=[l,...N(o)],h=k.filter(d=>Array.isArray(d.targetMuscle)?d.targetMuscle.some(g=>g===o||g===l||g.toLowerCase()===o.toLowerCase()||g.toLowerCase()===l.toLowerCase()):typeof d.targetMuscle=="string"?d.targetMuscle===o||d.targetMuscle===l||d.targetMuscle.toLowerCase()===o.toLowerCase()||d.targetMuscle.toLowerCase()===l.toLowerCase():!1),h.length===0&&(h=k.filter(d=>{const g=d.name?.toLowerCase()||"";return g.includes("二頭")||g.includes("bicep")}))}else e?(h=[...k],x.value=`${e} 相關動作`,v.value=!0,b.value=[]):(h=[...k],x.value="所有動作",v.value=!0,b.value=[]);const oe=e?e.split(","):[];y.value=oe,y.value.length>0&&(h=h.filter(o=>y.value.includes(o.equipment))),h=h.sort((o,d)=>o.name.localeCompare(d.name)),D.value=h,h.length}catch(l){console.error("載入動作失敗:",l),P.notify({color:"negative",message:"載入動作失敗",icon:"error"})}finally{z.value=!1}},V=l=>{const e={muscle:l};e.gender=M.value,S.push({path:"/muscle-exercises",query:e})};return de(()=>{$(),O().then(()=>{setTimeout(()=>{se()},500)})}),me(()=>{I.value&&I.value.disconnect()}),W(()=>[m.query.muscle,m.query.equipment,m.query.exerciseId],()=>{O()}),(l,e)=>(a(),_(Ee,{class:"q-pa-md"},{default:r(()=>[s("div",Te,[s("div",Be,[s("div",He,[z.value?(a(),c("div",Pe,[i(Fe,{size:"50px",color:"primary"}),e[3]||(e[3]=s("div",{class:"q-mt-md"},"載入中...",-1))])):D.value.length===0?(a(),c("div",Ue,[i(G,{name:"search_off",size:"4rem",color:"grey-5"}),e[4]||(e[4]=s("div",{class:"text-h6 q-mt-md text-grey-6"},"找不到相關動作",-1)),e[5]||(e[5]=s("div",{class:"text-body2 text-grey-5"},"請嘗試其他肌肉部位",-1))])):(a(),c("div",$e,[(a(!0),c(w,null,L(D.value,(t,Q)=>(a(),c("div",{key:Q,class:"q-mb-lg"},[i(T,{id:"exercise-"+t._id,class:he(["exercise-card cursor-pointer",{"highlighted-exercise":fe(m).query.exerciseId===t._id}]),flat:"",bordered:"",onClick:q=>te(t)},{default:r(()=>[s("div",Re,[s("div",je,[s("div",Oe,[t.video?(a(),c("video",{key:0,src:R(t.video),class:"exercise-video",preload:"auto",loop:"",muted:"",autoplay:"",playsinline:"","webkit-playsinline":"",ref_for:!0,ref:q=>ee(q,t._id)}," 您的瀏覽器不支援影片播放 ",8,We)):(a(),c("div",Ge,[i(G,{name:"play_circle_outline",size:"4rem",color:"grey-5"}),e[6]||(e[6]=s("div",{class:"text-caption text-grey-6"},"暫無影片",-1))]))])]),s("div",Je,[i(B,{class:"full-width"},{default:r(()=>[s("div",Ke,u(t.name),1),s("div",Xe,[i(E,{color:"blue","text-color":"white",icon:"fitness_center",size:"md"},{default:r(()=>[p(u(t.equipment),1)]),_:2},1024),(a(!0),c(w,null,L(t.targetMuscle,q=>(a(),_(E,{key:q,color:"orange","text-color":"white",icon:"accessibility_new",size:"md",class:"q-ml-xs"},{default:r(()=>[p(u(q),1)]),_:2},1024))),128))]),s("div",Ye,[e[7]||(e[7]=s("div",{class:"text-subtitle2 text-weight-medium"},"動作描述：",-1)),s("div",Ze,[t.description?(a(),c("div",es,u(t.description),1)):C("",!0),Array.isArray(t.notes)&&t.notes.length>0?(a(),c("div",ss,[s("ol",ts,[(a(!0),c(w,null,L(t.notes,(q,k)=>(a(),c("li",{key:k,class:"q-mb-xs"},u(q),1))),128))])])):t.notes&&!Array.isArray(t.notes)?(a(),c("div",ls,u(t.notes),1)):C("",!0),!t.description&&!t.notes?(a(),c("div",as,"暫無描述")):C("",!0)])])]),_:2},1024)])])]),_:2},1032,["id","class","onClick"])]))),128))]))]),s("div",os,[s("div",is,[i(T,{flat:"",bordered:"",class:"muscle-map-card"},{default:r(()=>[i(B,null,{default:r(()=>[s("div",rs,[i(pe,{size:"lg",modelValue:M.value,"onUpdate:modelValue":e[0]||(e[0]=t=>M.value=t),"checked-icon":"female",color:"pink","false-value":"男生","true-value":"女生",label:M.value,"unchecked-icon":"male"},null,8,["modelValue","label"])]),i(_e,{class:"q-mb-md"}),s("div",cs,[p(u(x.value)+u(x.value.includes("相關動作")?"":" 相關動作")+" ",1),y.value.length>0?(a(),c("div",ns," 器材："+u(y.value.join("、")),1)):C("",!0)]),s("div",us,[M.value==="男生"?(a(),c(w,{key:0},[v.value?(a(),_(X,{key:0,class:"muscle-model",selectedEquipments:y.value,highlightedMuscles:b.value,highlightColor:"rgba(244, 67, 54, 0.8)",customClickHandler:V},null,8,["selectedEquipments","highlightedMuscles"])):(a(),_(Y,{key:1,class:"muscle-model",selectedEquipments:y.value,highlightedMuscles:b.value,highlightColor:"rgba(244, 67, 54, 0.8)",customClickHandler:V},null,8,["selectedEquipments","highlightedMuscles"]))],64)):(a(),c(w,{key:1},[v.value?(a(),_(Le,{key:0,class:"muscle-model",selectedEquipments:y.value,highlightedMuscles:b.value,highlightColor:"rgba(244, 67, 54, 0.8)",customClickHandler:V},null,8,["selectedEquipments","highlightedMuscles"])):(a(),_(Ne,{key:1,class:"muscle-model",selectedEquipments:y.value,highlightedMuscles:b.value,highlightColor:"rgba(244, 67, 54, 0.8)",customClickHandler:V},null,8,["selectedEquipments","highlightedMuscles"]))],64))]),s("div",ds,[i(J,{flat:"",round:"",color:"primary",icon:v.value?"flip_to_back":"flip_to_front",onClick:e[1]||(e[1]=t=>v.value=!v.value)},{default:r(()=>[i(qe,null,{default:r(()=>[p(u(v.value?"切換到背面":"切換到正面"),1)]),_:1})]),_:1},8,["icon"])])]),_:1})]),_:1})])])])]),i(ye,{modelValue:F.value,"onUpdate:modelValue":e[2]||(e[2]=t=>F.value=t),maximized:!1,class:"exercise-dialog"},{default:r(()=>[n.value?(a(),_(T,{key:0,style:{width:"90vw","max-width":"1200px","max-height":"85vh"}},{default:r(()=>[i(Me,{class:"bg-primary text-white"},{default:r(()=>[i(ke,null,{default:r(()=>[p(u(n.value.name),1)]),_:1}),be(i(J,{flat:"",round:"",dense:"",icon:"close"},null,512),[[Ae]])]),_:1}),i(B,{class:"scroll",style:{"max-height":"calc(85vh - 56px)","overflow-y":"auto"}},{default:r(()=>[s("div",ms,[s("div",gs,[n.value.video?(a(),c("div",vs,[e[8]||(e[8]=s("div",{class:"text-h6 q-mb-sm"},"動作影片",-1)),s("video",{src:R(n.value.video),class:"full-width",style:{"max-height":"350px"},autoplay:"",loop:"",muted:"",playsinline:"","webkit-playsinline":""}," 您的瀏覽器不支援影片播放 ",8,hs)])):C("",!0),s("div",fs,[e[11]||(e[11]=s("div",{class:"text-h6 q-mb-sm"},"訓練部位圖解",-1)),s("div",ps,[s("div",_s,[e[9]||(e[9]=s("div",{class:"text-center q-mb-xs"},[s("div",{class:"text-subtitle2"},"正面")],-1)),s("div",ys,[i(X,{"highlighted-muscles":j(n.value.targetMuscle),"highlight-color":"#ff9800","custom-click-handler":()=>{}},null,8,["highlighted-muscles"])])]),s("div",bs,[e[10]||(e[10]=s("div",{class:"text-center q-mb-xs"},[s("div",{class:"text-subtitle2"},"背面")],-1)),s("div",xs,[i(Y,{"highlighted-muscles":j(n.value.targetMuscle),"highlight-color":"#ff9800","custom-click-handler":()=>{}},null,8,["highlighted-muscles"])])])])])]),s("div",qs,[s("div",Ms,[e[12]||(e[12]=s("div",{class:"text-h6"},"目標肌肉",-1)),Array.isArray(n.value.targetMuscle)?(a(),c("div",ks,[(a(!0),c(w,null,L(n.value.targetMuscle,t=>(a(),_(E,{key:t,color:"secondary","text-color":"white",class:"q-mr-xs q-mb-xs"},{default:r(()=>[p(u(t),1)]),_:2},1024))),128))])):(a(),_(E,{key:1,color:"secondary","text-color":"white"},{default:r(()=>[p(u(n.value.targetMuscle),1)]),_:1}))]),s("div",ws,[e[13]||(e[13]=s("div",{class:"text-h6"},"使用器材",-1)),i(E,{outline:"",icon:le(n.value.equipment),"text-color":"black"},{default:r(()=>[p(u(n.value.equipment),1)]),_:1},8,["icon"])]),s("div",Cs,[e[14]||(e[14]=s("div",{class:"text-h6"},"難易度",-1)),i(E,{color:ae(n.value.difficulty),"text-color":"white"},{default:r(()=>[p(u(n.value.difficulty),1)]),_:1},8,["color"])]),n.value.notes&&n.value.notes.length>0?(a(),c("div",Qs,[e[15]||(e[15]=s("div",{class:"text-h6 q-mb-sm"},"注意事項",-1)),i(Qe,{dense:""},{default:r(()=>[(a(!0),c(w,null,L(n.value.notes,(t,Q)=>(a(),_(we,{key:Q,class:"q-pa-sm"},{default:r(()=>[i(K,{avatar:""},{default:r(()=>[i(xe,{color:"warning","text-color":"white",size:"24px"},{default:r(()=>[p(u(Q+1),1)]),_:2},1024)]),_:2},1024),i(K,null,{default:r(()=>[i(Ce,{class:"text-body2"},{default:r(()=>[p(u(t),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):C("",!0)])])]),_:1})]),_:1})):C("",!0)]),_:1},8,["modelValue"])]),_:1}))}},js=ze(Es,[["__scopeId","data-v-84164514"]]);export{js as default};
