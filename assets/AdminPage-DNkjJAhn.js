import{u as je,Q as Oe}from"./article-BWcQGjFY.js";import{Q as xe,a as re,b as ke,c as ue}from"./QTabPanels-DyHw-Y6y.js";import{g as Ae,r as y,c as M,K as Be,M as ze,E as Le,h as W,m as He,b0 as Je,aM as Ke,b1 as We,b2 as Xe,b3 as Ye,b4 as Ge,b5 as Ve,aR as Ze,b6 as et,J as tt,a9 as lt,w as at,o as ot,aa as E,ab as m,ac as n,ae as st,ai as b,f as l,ag as s,ao as F,aq as nt,ah as q,F as L,aj as H,as as ge,at as oe,ak as g,ay as Q,az as qe,av as be,an as J,au as ye,ax as Ce,al as Y}from"./index-Bn42XH2Q.js";import{Q as it}from"./QExpansionItem-CvVOF5H0.js";import{Q as Fe,a as G}from"./QTable-CEYXPMf3.js";import{Q as X}from"./QChip-4Dk9RzM6.js";import{Q as Se,a as Me}from"./QItemLabel-CkehzaSt.js";import{Q as Ue}from"./QList-CU7fouqH.js";import{Q as he}from"./QSelect-l1WsnEj9.js";import{h as rt}from"./format-CoaQEihs.js";import{Q as ut}from"./QPage-CE1UNi1s.js";import{u as dt}from"./use-quasar-B9tJROjq.js";import{r as _e}from"./routine-CuuvH8Q_.js";import{w as de}from"./wiki-BbAW4oNI.js";import{v as ct}from"./muscleMapping-CknbMQiE.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./touch-CjDUbXLY.js";import"./rtl-DFPa-2ov.js";import"./selection-CqqBGjGe.js";import"./use-render-cache-DLxPkVnQ.js";import"./position-engine-C9dRj_c-.js";function Z(r,p,N,S){const h=[];return r.forEach(_=>{S(_)===!0?h.push(_):p.push({failedPropValidation:N,file:_})}),h}function ce(r){r?.dataTransfer&&(r.dataTransfer.dropEffect="copy"),ze(r)}const ft={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},vt=["rejected"];function pt({editable:r,dnd:p,getFileInput:N,addFilesToQueue:S}){const{props:h,emit:_,proxy:U}=Ae(),D=y(null),k=M(()=>h.accept!==void 0?h.accept.split(",").map(i=>(i=i.trim(),i==="*"?"*/":(i.endsWith("/*")&&(i=i.slice(0,i.length-1)),i.toUpperCase()))):null),I=M(()=>parseInt(h.maxFiles,10)),P=M(()=>parseInt(h.maxTotalSize,10));function R(i){if(r.value)if(i!==Object(i)&&(i={target:null}),i.target?.matches('input[type="file"]')===!0)i.clientX===0&&i.clientY===0&&Be(i);else{const C=N();C!==i.target&&C?.click(i)}}function j(i){r.value&&i&&S(null,i)}function ee(i,C,$,K){let d=Array.from(C||i.target.files);const w=[],A=()=>{w.length!==0&&_("rejected",w)};if(h.accept!==void 0&&k.value.indexOf("*/")===-1&&(d=Z(d,w,"accept",o=>k.value.some(x=>o.type.toUpperCase().startsWith(x)||o.name.toUpperCase().endsWith(x))),d.length===0))return A();if(h.maxFileSize!==void 0){const o=parseInt(h.maxFileSize,10);if(d=Z(d,w,"max-file-size",x=>x.size<=o),d.length===0)return A()}if(h.multiple!==!0&&d.length!==0&&(d=[d[0]]),d.forEach(o=>{o.__key=o.webkitRelativePath+o.lastModified+o.name+o.size}),K===!0){const o=$.map(x=>x.__key);d=Z(d,w,"duplicate",x=>o.includes(x.__key)===!1)}if(d.length===0)return A();if(h.maxTotalSize!==void 0){let o=K===!0?$.reduce((x,le)=>x+le.size,0):0;if(d=Z(d,w,"max-total-size",x=>(o+=x.size,o<=P.value)),d.length===0)return A()}if(typeof h.filter=="function"){const o=h.filter(d);d=Z(d,w,"filter",x=>o.includes(x))}if(h.maxFiles!==void 0){let o=K===!0?$.length:0;if(d=Z(d,w,"max-files",()=>(o++,o<=I.value)),d.length===0)return A()}if(A(),d.length!==0)return d}function O(i){ce(i),p.value!==!0&&(p.value=!0)}function u(i){ze(i),(i.relatedTarget!==null||Le.is.safari!==!0?i.relatedTarget!==D.value:document.elementsFromPoint(i.clientX,i.clientY).includes(D.value)===!1)===!0&&(p.value=!1)}function T(i){ce(i);const C=i.dataTransfer.files;C.length!==0&&S(null,C),p.value=!1}function te(i){if(p.value===!0)return W("div",{ref:D,class:`q-${i}__dnd absolute-full`,onDragenter:ce,onDragover:ce,onDragleave:u,onDrop:T})}return Object.assign(U,{pickFiles:R,addFiles:j}),{pickFiles:R,addFiles:j,onDragover:O,onDragleave:u,processFiles:ee,getDndNode:te,maxFilesNumber:I,maxTotalSizeNumber:P}}const gt=He({name:"QFile",inheritAttrs:!1,props:{...We,...Ke,...ft,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Je,...vt],setup(r,{slots:p,emit:N,attrs:S}){const{proxy:h}=Ae(),_=Xe(),U=y(null),D=y(!1),k=Ye(r),{pickFiles:I,onDragover:P,onDragleave:R,processFiles:j,getDndNode:ee}=pt({editable:_.editable,dnd:D,getFileInput:se,addFilesToQueue:ne}),O=Ge(r),u=M(()=>Object(r.modelValue)===r.modelValue?"length"in r.modelValue?Array.from(r.modelValue):[r.modelValue]:[]),T=M(()=>Ve(u.value)),te=M(()=>u.value.map(c=>c.name).join(", ")),i=M(()=>rt(u.value.reduce((c,V)=>c+V.size,0))),C=M(()=>({totalSize:i.value,filesNumber:u.value.length,maxFiles:r.maxFiles})),$=M(()=>({tabindex:-1,type:"file",title:"",accept:r.accept,capture:r.capture,name:k.value,...S,id:_.targetUid.value,disabled:_.editable.value!==!0})),K=M(()=>"q-file q-field--auto-height"+(D.value===!0?" q-file--dnd":"")),d=M(()=>r.multiple===!0&&r.append===!0);function w(c){const V=u.value.slice();V.splice(c,1),o(V)}function A(c){const V=u.value.indexOf(c);V!==-1&&w(V)}function o(c){N("update:modelValue",r.multiple===!0?c:c[0])}function x(c){c.keyCode===13&&tt(c)}function le(c){(c.keyCode===13||c.keyCode===32)&&I(c)}function se(){return U.value}function ne(c,V){const z=j(c,V,u.value,d.value),ae=se();ae!=null&&(ae.value=""),z!==void 0&&((r.multiple===!0?r.modelValue&&z.every(ve=>u.value.includes(ve)):r.modelValue===z[0])||o(d.value===!0?u.value.concat(z):z))}function B(){return[W("input",{class:[r.inputClass,"q-file__filler"],style:r.inputStyle})]}function me(){if(p.file!==void 0)return u.value.length===0?B():u.value.map((V,z)=>p.file({index:z,file:V,ref:this}));if(p.selected!==void 0)return u.value.length===0?B():p.selected({files:u.value,ref:this});if(r.useChips===!0)return u.value.length===0?B():u.value.map((V,z)=>W(X,{key:"file-"+z,removable:_.editable.value,dense:!0,textColor:r.color,tabindex:r.tabindex,onRemove:()=>{w(z)}},()=>W("span",{class:"ellipsis",textContent:V.name})));const c=r.displayValue!==void 0?r.displayValue:te.value;return c.length!==0?[W("div",{class:r.inputClass,style:r.inputStyle,textContent:c})]:B()}function fe(){const c={ref:U,...$.value,...O.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:ne};return r.multiple===!0&&(c.multiple=!0),W("input",c)}return Object.assign(_,{fieldClass:K,emitValue:o,hasValue:T,inputRef:U,innerValue:u,floatingLabel:M(()=>T.value===!0||Ve(r.displayValue)),computedCounter:M(()=>{if(r.counterLabel!==void 0)return r.counterLabel(C.value);const c=r.maxFiles;return`${u.value.length}${c!==void 0?" / "+c:""} (${i.value})`}),getControlChild:()=>ee("file"),getControl:()=>{const c={ref:_.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:r.tabindex};return _.editable.value===!0&&Object.assign(c,{onDragover:P,onDragleave:R,onKeydown:x,onKeyup:le}),W("div",c,[fe()].concat(me()))}}),Object.assign(h,{removeAtIndex:w,removeFile:A,getNativeElement:()=>U.value}),Ze(h,"nativeEl",()=>U.value),et(_)}}),bt={key:0,class:"text-center q-pa-xl"},yt={key:1,class:"container fade-in-up"},ht={class:"row justify-between items-center q-mb-md"},_t={class:"row q-col-gutter-lg"},wt={class:"row justify-between items-center q-mb-sm"},xt={class:"text-h6"},kt={class:"q-pt-md"},Vt={class:"row q-col-gutter-sm"},qt={class:"col-6"},Ct={class:"col-6"},Ft={class:"text-center q-mb-sm"},St=["src","alt"],Mt={class:"row justify-between items-center q-mb-md"},Ut={key:0},At={class:"q-mb-md"},zt={class:"q-mb-md"},Qt={class:"q-mb-md"},Tt={class:"q-mb-md"},Et={class:"q-mb-md"},Nt={key:0},Dt={class:"day-detail"},$t={class:"text-h6 q-mb-sm"},It={key:0},Pt={key:0,class:"rest-day-admin q-pa-md text-center"},Rt={key:0,class:"text-body2 text-grey-6 q-mt-sm"},jt={key:1},Ot={class:"row items-center"},Bt={key:0,class:"day-notes-admin q-pa-sm q-mt-sm"},Lt={class:"text-caption text-weight-medium"},Ht={class:"text-body2"},Jt={key:2,class:"no-workouts-admin q-pa-md text-center"},Kt={key:1},Wt={class:"row items-center"},Xt={key:2,class:"no-content-admin q-pa-md text-center"},Yt={class:"text-h6"},Gt={class:"q-mb-md"},Zt={class:"col"},el={class:"col-auto"},tl={class:"q-mb-md"},ll={class:"col"},al={class:"col-auto"},ol={__name:"AdminPage",setup(r){const p=dt(),N=lt(),S=je(),h=st(),_=y("homepage"),U=y(!1),D=()=>{if(N.isLoggedIn){if(!N.isAdmin)return U.value=!1,p.notify({color:"red-5",textColor:"white",icon:"warning",message:"您沒有權限訪問此頁面"}),h.push("/"),!1}else return U.value=!1,p.notify({color:"red-5",textColor:"white",icon:"warning",message:"請先登入"}),h.push("/login"),!1;return U.value=!0,!0};at(()=>N.isLoggedIn,()=>{D()},{immediate:!0});const k=y([{title:"健身新手指南",description:"從零開始的健身之路，教你正確的健身觀念與基本動作",author:"MuscleMap 編輯部",image:"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop",link:"https://example.com/fitness-guide",buttonText:"開始學習"},{title:"營養補充全攻略",description:"了解蛋白質、碳水化合物與脂肪的正確攝取比例",author:"MuscleMap 編輯部",image:"https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=400&h=300&fit=crop",link:"https://example.com/nutrition-guide",buttonText:"立即了解"},{title:"重量訓練技巧",description:"掌握正確的重訓姿勢，避免運動傷害，提升訓練效果",author:"MuscleMap 編輯部",image:"https://images.unsplash.com/photo-1534438327276-14e5300c3a48?w=400&h=300&fit=crop",link:"https://example.com/weight-training",buttonText:"查看技巧"},{title:"有氧運動指南",description:"選擇適合你的有氧運動，提升心肺功能與燃脂效率",author:"MuscleMap 編輯部",image:"https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=400&h=300&fit=crop",link:"https://example.com/cardio-guide",buttonText:"開始運動"},{title:"恢復與休息",description:"學會正確的休息與恢復方法，讓你的訓練事半功倍",author:"MuscleMap 編輯部",image:"https://images.unsplash.com/photo-1506126613408-eca07ce68773?w=400&h=300&fit=crop",link:"https://example.com/recovery-guide",buttonText:"了解更多"},{title:"運動心理學",description:"建立正確的運動心態，維持長期的健身動機",author:"MuscleMap 編輯部",image:"https://images.unsplash.com/photo-1518611012118-696072aa579a?w=400&h=300&fit=crop",link:"https://example.com/sports-psychology",buttonText:"心理建設"}]),I=y(null),P=y([]),R=y(!1),j=y(""),ee=y({page:1,rowsPerPage:10}),O=y(!1),u=y(null),T=y("monday"),te=[{name:"title",required:!0,label:"標題",align:"left",field:"title",sortable:!0},{name:"user",label:"建立者",align:"left",field:a=>a.user?.username||"未知",sortable:!0},{name:"isPublic",label:"狀態",align:"center",field:"isPublic",sortable:!0},{name:"likesCount",label:"讚數",align:"center",field:"likesCount",sortable:!0},{name:"createdAt",label:"建立時間",align:"center",field:"createdAt",sortable:!0,format:a=>new Date(a).toLocaleDateString()},{name:"actions",label:"操作",align:"center"}],i=y([]),C=y(!1),$=y(""),K=y({page:1,rowsPerPage:10}),d=y(!1),w=y(!1),A=y(!1),o=y({name:"",equipment:"",difficulty:"",targetMuscle:[""],video:null,notes:["","",""]}),x=[{name:"name",required:!0,label:"動作名稱",align:"left",field:"name",sortable:!0},{name:"equipment",label:"器材",align:"center",field:"equipment",sortable:!0},{name:"difficulty",label:"難度",align:"center",field:"difficulty",sortable:!0},{name:"targetMuscle",label:"目標肌群",align:"center",field:"targetMuscle",sortable:!0},{name:"actions",label:"操作",align:"center"}],le=["啞鈴","器械","壺鈴","繩索","槓片","史密斯","槓鈴","徒手","藥球","伸展","彈力繩","有氧"],se=["簡單","普通","困難"],ne=ct,B=async()=>{try{await S.loadAllArticles({limit:100,featured:void 0,active:void 0}),k.value=S.articles}catch(a){console.log("從 API 載入失敗，嘗試載入本地資料",a);const t=localStorage.getItem("homepage-articles");t?k.value=JSON.parse(t):k.value=S.getFallbackArticles()}},me=async a=>{I.value=a;try{const t=k.value[a];if(t._id)await S.updateArticle(t._id,t),p.notify({color:"positive",textColor:"white",icon:"check",message:`文章「${t.title}」更新成功`});else{const e=await S.createArticle(t);k.value[a]._id=e._id,p.notify({color:"positive",textColor:"white",icon:"check",message:`文章「${t.title}」建立成功`})}localStorage.setItem("homepage-articles",JSON.stringify(k.value)),await B()}catch(t){console.error("儲存失敗:",t),p.notify({color:"red-5",textColor:"white",icon:"warning",message:`儲存失敗: ${t.message||"未知錯誤"}`})}finally{I.value=null}},fe=async a=>{const t=k.value[a];p.dialog({title:"確認刪除",message:`確定要刪除文章「${t.title}」嗎？`,persistent:!0,ok:{push:!0,label:"確認刪除",color:"negative"},cancel:{push:!0,label:"取消",color:"grey"}}).onOk(async()=>{try{t._id&&await S.deleteArticle(t._id),k.value.splice(a,1),localStorage.setItem("homepage-articles",JSON.stringify(k.value)),await B(),p.notify({color:"positive",textColor:"white",icon:"check",message:`文章「${t.title}」刪除成功`})}catch(e){console.error("刪除失敗:",e),p.notify({color:"red-5",textColor:"white",icon:"warning",message:`刪除失敗: ${e.message||"未知錯誤"}`})}}).onCancel(()=>{console.log("用戶取消了刪除操作")})},c=()=>{const a={title:"新文章標題",description:"請輸入文章描述",author:"MuscleMap 編輯部",image:"",link:"",buttonText:"閱讀更多",isFeatured:!0,isActive:!0,order:k.value.length};k.value.push(a)},V=async()=>{R.value=!0;try{const{data:a}=await _e.getAllRoutines();P.value=a.data||[]}catch(a){console.error("載入課表失敗:",a),console.error("錯誤詳情:",a.response?.data);try{const{data:t}=await _e.getPublicRoutines();P.value=t.data||[]}catch(t){console.error("載入公開課表也失敗:",t),p.notify({color:"red-5",textColor:"white",icon:"warning",message:"載入課表失敗"})}}finally{R.value=!1}},z=()=>{V()},ae=a=>{u.value=a,a.weeklyPlan&&a.weeklyPlan.length>0&&(T.value=a.weeklyPlan[0].day),O.value=!0},ve=async a=>{p.dialog({title:"確認刪除",message:"您確定要刪除這個課表嗎？此操作無法復原。",cancel:!0,persistent:!0}).onOk(async()=>{try{await _e.adminDelete(a),await V(),p.notify({color:"positive",textColor:"white",icon:"check",message:"課表刪除成功"})}catch(t){console.error("刪除課表失敗:",t),console.error("錯誤詳情:",t.response?.data),p.notify({color:"red-5",textColor:"white",icon:"warning",message:t.response?.data?.message||"刪除課表失敗"})}})},ie=async()=>{C.value=!0;try{const{data:a}=await de.getExercises();i.value=a.exercises||[]}catch(a){console.error("載入動作失敗:",a),p.notify({color:"red-5",textColor:"white",icon:"warning",message:"載入動作失敗"})}finally{C.value=!1}},Qe=()=>{ie()},Te=a=>{w.value=!0,o.value={_id:a._id,name:a.name,equipment:a.equipment,difficulty:a.difficulty,targetMuscle:Array.isArray(a.targetMuscle)?[...a.targetMuscle]:[a.targetMuscle||""],video:null,notes:a.notes&&a.notes.length>=3?[...a.notes]:["","",""]},d.value=!0},we=()=>{d.value=!1,w.value=!1,o.value={name:"",equipment:"",difficulty:"",targetMuscle:[""],video:null,notes:["","",""]}},Ee=async()=>{A.value=!0;try{const a=new FormData;a.append("name",o.value.name),a.append("equipment",o.value.equipment),a.append("difficulty",o.value.difficulty),o.value.targetMuscle.forEach((t,e)=>{t.trim()&&a.append(`targetMuscle[${e}]`,t)}),o.value.notes.forEach((t,e)=>{t.trim()&&a.append(`notes[${e}]`,t)}),o.value.video&&a.append("video",o.value.video),w.value?await de.updateExercise(o.value._id,a):await de.createExercise(a),p.notify({color:"positive",textColor:"white",icon:"check",message:w.value?"動作更新成功":"動作建立成功"}),we(),await ie()}catch(a){console.error("儲存動作失敗:",a),p.notify({color:"red-5",textColor:"white",icon:"warning",message:a.response?.data?.message||"儲存動作失敗"})}finally{A.value=!1}},Ne=async a=>{p.dialog({title:"確認刪除",message:"您確定要刪除這個動作嗎？此操作無法復原。",cancel:!0,persistent:!0}).onOk(async()=>{try{await de.deleteExercise(a),await ie(),p.notify({color:"positive",textColor:"white",icon:"check",message:"動作刪除成功"})}catch(t){console.error("刪除動作失敗:",t),console.error("錯誤詳情:",t.response?.data),p.notify({color:"red-5",textColor:"white",icon:"warning",message:t.response?.data?.message||"刪除動作失敗"})}})},De=a=>{switch(a){case"簡單":return"green";case"普通":return"orange";case"困難":return"red";default:return"grey"}},$e=()=>{o.value.targetMuscle.push("")},Ie=a=>{o.value.targetMuscle.length>1&&o.value.targetMuscle.splice(a,1)},Pe=()=>{o.value.notes.push("")},Re=a=>{o.value.notes.length>3&&o.value.notes.splice(a,1)},pe=a=>({monday:"星期一",tuesday:"星期二",wednesday:"星期三",thursday:"星期四",friday:"星期五",saturday:"星期六",sunday:"星期日"})[a]||a;return ot(async()=>{D()&&(B(),await V(),await ie())}),(a,t)=>(m(),E(ut,{class:"q-pa-md"},{default:n(()=>[U.value?(m(),b("div",yt,[t[33]||(t[33]=s("div",{class:"text-center"},[s("h1",{class:"section text-h4 q-mt-lg"},"管理頁面"),s("p",{class:"section-description text-center q-mb-lg"},[F(" 在這裡您可以查看和管理自己的課表，建立新的課表或編輯現有的課表。"),s("br"),F(" 您也可以瀏覽其他用戶分享的公開課表，並將喜歡的課表加入收藏。 ")])],-1)),l(xe,{modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),"inline-label":"","outside-arrows":"","mobile-arrows":"",class:"text-teal q-mb-md"},{default:n(()=>[l(re,{name:"homepage",icon:"home",label:"首頁內容管理"}),l(re,{name:"routines",icon:"event_note",label:"課表管理"}),l(re,{name:"wiki",icon:"menu_book",label:"百科管理"})]),_:1},8,["modelValue"]),l(nt),l(ke,{modelValue:_.value,"onUpdate:modelValue":t[4]||(t[4]=e=>_.value=e),animated:""},{default:n(()=>[l(ue,{name:"homepage"},{default:n(()=>[s("div",ht,[t[15]||(t[15]=s("div",{class:"text-h6"},"精選文章管理",-1)),l(q,{color:"primary",icon:"add",label:"新增文章",onClick:c})]),s("div",_t,[(m(!0),b(L,null,H(k.value,(e,f)=>(m(),b("div",{key:e._id||f,class:"col-12 col-md-6 col-lg-4"},[l(ge,{class:"q-pa-md"},{default:n(()=>[l(oe,null,{default:n(()=>[s("div",wt,[s("div",xt,g(e._id?"編輯文章":"新文章")+" "+g(f+1),1),l(q,{flat:"",round:"",color:"negative",icon:"delete",size:"sm",onClick:v=>fe(f)},null,8,["onClick"])]),l(Q,{modelValue:e.title,"onUpdate:modelValue":v=>e.title=v,label:"標題",outlined:"",class:"q-mb-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(Q,{modelValue:e.description,"onUpdate:modelValue":v=>e.description=v,label:"描述",type:"textarea",rows:"3",outlined:"",class:"q-mb-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(Q,{modelValue:e.author,"onUpdate:modelValue":v=>e.author=v,label:"作者",outlined:"",class:"q-mb-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(Q,{modelValue:e.link,"onUpdate:modelValue":v=>e.link=v,label:"文章連結",outlined:"",class:"q-mb-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(Q,{modelValue:e.image,"onUpdate:modelValue":v=>e.image=v,label:"圖片網址",outlined:"",class:"q-mb-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(Q,{modelValue:e.buttonText,"onUpdate:modelValue":v=>e.buttonText=v,label:"按鈕文字",outlined:"",class:"q-mb-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(it,{label:"進階選項",class:"q-mb-sm"},{default:n(()=>[s("div",kt,[s("div",Vt,[s("div",qt,[l(qe,{modelValue:e.isFeatured,"onUpdate:modelValue":v=>e.isFeatured=v,label:"設為精選"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Ct,[l(qe,{modelValue:e.isActive,"onUpdate:modelValue":v=>e.isActive=v,label:"啟用顯示"},null,8,["modelValue","onUpdate:modelValue"])])]),l(Q,{modelValue:e.order,"onUpdate:modelValue":v=>e.order=v,modelModifiers:{number:!0},label:"排序順序",type:"number",outlined:"",class:"q-mt-sm"},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),s("div",Ft,[s("img",{src:e.image||"https://cdn.quasar.dev/img/mountains.jpg",alt:e.title,style:{width:"100%",height:"150px","object-fit":"cover","border-radius":"4px"}},null,8,St)])]),_:2},1024),l(be,{align:"center"},{default:n(()=>[l(q,{color:"primary",label:e._id?"更新":"建立",onClick:v=>me(f),loading:I.value===f},null,8,["label","onClick","loading"])]),_:2},1024)]),_:2},1024)]))),128))])]),_:1}),l(ue,{name:"routines"},{default:n(()=>[t[16]||(t[16]=s("div",{class:"text-h6 q-mb-md"},"用戶課表管理",-1)),l(Fe,{rows:P.value,columns:te,"row-key":"_id",loading:R.value,filter:j.value,pagination:ee.value,onRequest:z},{"top-right":n(()=>[l(Q,{borderless:"",dense:"",debounce:"300",modelValue:j.value,"onUpdate:modelValue":t[1]||(t[1]=e=>j.value=e),placeholder:"搜尋課表"},{append:n(()=>[l(J,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":n(e=>[l(G,{props:e},{default:n(()=>[l(q,{flat:"",color:"primary",icon:"visibility",size:"sm",onClick:f=>ae(e.row)},null,8,["onClick"]),l(q,{flat:"",color:"negative",icon:"delete",size:"sm",onClick:f=>ve(e.row._id)},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-isPublic":n(e=>[l(G,{props:e},{default:n(()=>[l(X,{color:e.value?"green":"orange","text-color":"white",size:"sm"},{default:n(()=>[F(g(e.value?"公開":"私人"),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter","pagination"])]),_:1,__:[16]}),l(ue,{name:"wiki"},{default:n(()=>[t[18]||(t[18]=s("div",{class:"text-h6 q-mb-md"},"動作百科管理",-1)),s("div",Mt,[t[17]||(t[17]=s("div",{class:"text-subtitle1"},"動作列表",-1)),l(q,{color:"primary",icon:"add",label:"新增動作",onClick:t[2]||(t[2]=e=>d.value=!0)})]),l(Fe,{rows:i.value,columns:x,"row-key":"_id",loading:C.value,filter:$.value,pagination:K.value,onRequest:Qe},{"top-right":n(()=>[l(Q,{borderless:"",dense:"",debounce:"300",modelValue:$.value,"onUpdate:modelValue":t[3]||(t[3]=e=>$.value=e),placeholder:"搜尋動作"},{append:n(()=>[l(J,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":n(e=>[l(G,{props:e},{default:n(()=>[l(q,{flat:"",color:"primary",icon:"edit",size:"md",onClick:f=>Te(e.row)},null,8,["onClick"]),l(q,{flat:"",color:"negative",icon:"delete",size:"sm",onClick:f=>Ne(e.row._id)},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-equipment":n(e=>[l(G,{props:e},{default:n(()=>[l(X,{color:"blue","text-color":"white",size:"md"},{default:n(()=>[F(g(e.value),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-difficulty":n(e=>[l(G,{props:e},{default:n(()=>[l(X,{color:De(e.value),"text-color":"white",size:"md"},{default:n(()=>[F(g(e.value),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-targetMuscle":n(e=>[l(G,{props:e},{default:n(()=>[Array.isArray(e.value)?(m(),b("div",Ut,[(m(!0),b(L,null,H(e.value,f=>(m(),E(X,{key:f,color:"purple","text-color":"white",size:"md",class:"q-mr-xs q-mb-xs"},{default:n(()=>[F(g(f),1)]),_:2},1024))),128))])):(m(),E(X,{key:1,color:"purple","text-color":"white",size:"sm"},{default:n(()=>[F(g(e.value),1)]),_:2},1024))]),_:2},1032,["props"])]),_:1},8,["rows","loading","filter","pagination"])]),_:1,__:[18]})]),_:1},8,["modelValue"]),l(ye(Ce),{modelValue:O.value,"onUpdate:modelValue":t[8]||(t[8]=e=>O.value=e),position:"standard"},{default:n(()=>[l(ge,{style:{"min-width":"600px"}},{default:n(()=>[l(oe,null,{default:n(()=>t[19]||(t[19]=[s("div",{class:"text-h6"},"課表詳情",-1)])),_:1,__:[19]}),u.value?(m(),E(oe,{key:0},{default:n(()=>[s("div",At,[t[20]||(t[20]=s("strong",null,"標題：",-1)),F(g(u.value.title),1)]),s("div",zt,[t[21]||(t[21]=s("strong",null,"描述：",-1)),F(g(u.value.content),1)]),s("div",Qt,[t[22]||(t[22]=s("strong",null,"建立者：",-1)),F(g(u.value.user?.username||"未知"),1)]),s("div",Tt,[t[23]||(t[23]=s("strong",null,"狀態：",-1)),l(X,{color:u.value.isPublic?"green":"orange","text-color":"white",size:"sm"},{default:n(()=>[F(g(u.value.isPublic?"公開":"私人"),1)]),_:1},8,["color"])]),s("div",Et,[t[24]||(t[24]=s("strong",null,"讚數：",-1)),F(g(u.value.likesCount||0),1)]),t[30]||(t[30]=s("div",{class:"text-subtitle1 q-mb-sm"},"課表內容：",-1)),u.value.weeklyPlan&&u.value.weeklyPlan.length>0?(m(),b("div",Nt,[l(xe,{modelValue:T.value,"onUpdate:modelValue":t[5]||(t[5]=e=>T.value=e),class:"q-mb-md",align:"left"},{default:n(()=>[(m(!0),b(L,null,H(u.value.weeklyPlan,e=>(m(),E(re,{key:e.day,name:e.day,label:pe(e.day)},null,8,["name","label"]))),128))]),_:1},8,["modelValue"]),l(ke,{modelValue:T.value,"onUpdate:modelValue":t[6]||(t[6]=e=>T.value=e),animated:""},{default:n(()=>[(m(!0),b(L,null,H(u.value.weeklyPlan,e=>(m(),E(ue,{key:e.day,name:e.day},{default:n(()=>[s("div",Dt,[s("div",$t,[F(g(pe(e.day))+" ",1),e.name&&e.name!==pe(e.day)?(m(),b("span",It," - "+g(e.name),1)):Y("",!0)]),e.isRestDay?(m(),b("div",Pt,[l(J,{name:"bed",size:"2rem",color:"grey-5"}),t[25]||(t[25]=s("div",{class:"text-body1 q-mt-sm text-grey-6"},"休息日",-1)),e.notes?(m(),b("div",Rt,g(e.notes),1)):Y("",!0)])):e.workouts&&e.workouts.length>0?(m(),b("div",jt,[l(Ue,{bordered:""},{default:n(()=>[(m(!0),b(L,null,H(e.workouts,(f,v)=>(m(),E(Se,{key:v,class:"workout-item-admin"},{default:n(()=>[l(Me,null,{default:n(()=>[s("div",Ot,[l(J,{name:"fitness_center",color:"primary",class:"q-mr-sm"}),s("div",null,g(f.exercise?.name||"未知動作")+" - "+g(f.sets)+"組 x "+g(f.reps)+"次 (休息 "+g(f.rest)+"秒) ",1)])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),e.notes?(m(),b("div",Bt,[s("div",Lt,[l(J,{name:"note",class:"q-mr-xs"}),t[26]||(t[26]=F(" 備註： "))]),s("div",Ht,g(e.notes),1)])):Y("",!0)])):(m(),b("div",Jt,[l(J,{name:"info",size:"1.5rem",color:"grey-5"}),t[27]||(t[27]=s("div",{class:"text-body2 q-mt-sm text-grey-6"},"此日尚未安排訓練",-1))]))])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])):u.value.workouts&&u.value.workouts.length>0?(m(),b("div",Kt,[t[28]||(t[28]=s("div",{class:"text-caption text-grey-6 q-mb-sm"},"（舊格式課表）",-1)),l(Ue,{bordered:""},{default:n(()=>[(m(!0),b(L,null,H(u.value.workouts,(e,f)=>(m(),E(Se,{key:f},{default:n(()=>[l(Me,null,{default:n(()=>[s("div",Wt,[l(J,{name:"fitness_center",color:"primary",class:"q-mr-sm"}),s("div",null,g(e.exercise?.name||"未知動作")+" - "+g(e.sets)+"組 x "+g(e.reps)+"次 (休息 "+g(e.rest)+"秒) ",1)])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(m(),b("div",Xt,[l(J,{name:"info",size:"2rem",color:"grey-5"}),t[29]||(t[29]=s("div",{class:"text-body1 q-mt-sm text-grey-6"},"此課表尚未設定訓練內容",-1))]))]),_:1,__:[30]})):Y("",!0),l(be,{align:"right"},{default:n(()=>[l(q,{flat:"",label:"關閉",onClick:t[7]||(t[7]=e=>O.value=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ye(Ce),{modelValue:d.value,"onUpdate:modelValue":t[13]||(t[13]=e=>d.value=e),position:"standard"},{default:n(()=>[l(ge,{style:{"min-width":"500px"}},{default:n(()=>[l(oe,null,{default:n(()=>[s("div",Yt,g(w.value?"編輯動作":"新增動作"),1)]),_:1}),l(oe,null,{default:n(()=>[l(Q,{modelValue:o.value.name,"onUpdate:modelValue":t[9]||(t[9]=e=>o.value.name=e),label:"動作名稱",outlined:"",class:"q-mb-md"},null,8,["modelValue"]),l(he,{modelValue:o.value.equipment,"onUpdate:modelValue":t[10]||(t[10]=e=>o.value.equipment=e),label:"器材",options:le,outlined:"",class:"q-mb-md"},null,8,["modelValue"]),l(he,{modelValue:o.value.difficulty,"onUpdate:modelValue":t[11]||(t[11]=e=>o.value.difficulty=e),label:"難度",options:se,outlined:"",class:"q-mb-md"},null,8,["modelValue"]),s("div",Gt,[t[31]||(t[31]=s("div",{class:"text-subtitle1 q-mb-sm"},"目標肌群",-1)),(m(!0),b(L,null,H(o.value.targetMuscle,(e,f)=>(m(),b("div",{key:f,class:"row q-gutter-sm q-mb-sm"},[s("div",Zt,[l(he,{modelValue:o.value.targetMuscle[f],"onUpdate:modelValue":v=>o.value.targetMuscle[f]=v,label:`目標肌群 ${f+1}`,options:ye(ne),outlined:""},null,8,["modelValue","onUpdate:modelValue","label","options"])]),s("div",el,[o.value.targetMuscle.length>1?(m(),E(q,{key:0,flat:"",round:"",color:"negative",icon:"remove",onClick:v=>Ie(f)},null,8,["onClick"])):Y("",!0)])]))),128)),l(q,{flat:"",color:"primary",icon:"add",label:"新增目標肌群",onClick:$e,class:"q-mb-md"})]),l(gt,{modelValue:o.value.video,"onUpdate:modelValue":t[12]||(t[12]=e=>o.value.video=e),label:"教學影片",outlined:"",accept:"video/*",class:"q-mb-md"},null,8,["modelValue"]),s("div",tl,[t[32]||(t[32]=s("div",{class:"text-subtitle1 q-mb-sm"},"注意事項 (至少需要三項)",-1)),(m(!0),b(L,null,H(o.value.notes,(e,f)=>(m(),b("div",{key:f,class:"row q-gutter-sm q-mb-sm"},[s("div",ll,[l(Q,{modelValue:o.value.notes[f],"onUpdate:modelValue":v=>o.value.notes[f]=v,label:`注意事項 ${f+1}`,outlined:"",rules:[v=>!!v||`請填寫第${f+1}項注意事項`,v=>v&&v.length<=200||"注意事項不能超過200字"]},null,8,["modelValue","onUpdate:modelValue","label","rules"])]),s("div",al,[o.value.notes.length>3?(m(),E(q,{key:0,flat:"",round:"",color:"negative",icon:"remove",onClick:v=>Re(f)},null,8,["onClick"])):Y("",!0)])]))),128)),l(q,{flat:"",color:"primary",icon:"add",label:"新增注意事項",onClick:Pe})])]),_:1}),l(be,{align:"right"},{default:n(()=>[l(q,{flat:"",label:"取消",onClick:we}),l(q,{color:"primary",label:w.value?"更新":"建立",onClick:Ee,loading:A.value},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):(m(),b("div",bt,[l(Oe,{color:"primary",size:"3em"}),t[14]||(t[14]=s("div",{class:"q-mt-md text-grey-6"},"檢查權限中...",-1))]))]),_:1}))}},Cl=mt(ol,[["__scopeId","data-v-bb3406db"]]);export{Cl as default};
