import{a9 as w,r as y,ar as x,ae as M,aa as h,ab as Q,ac as c,ag as t,f as o,as as q,at as V,au as e,ay as i,ah as m}from"./index-Bn42XH2Q.js";import{Q as S}from"./QForm-Cmlr_ukS.js";import{Q as C}from"./QPage-CE1UNi1s.js";import{u as $,c as z,a as g,b as p}from"./index.esm-CSjafN7A.js";import{u as B}from"./use-quasar-B9tJROjq.js";const k={class:"container"},F={class:"row justify-center"},U={class:"col-12 col-sm-8 col-md-6 col-lg-4"},L={class:"text-center q-mt-md"},N={class:"text-center q-mt-md"},E={__name:"LoginPage",setup(P){const d=B(),v=M(),f=w(),u=y(!1),_=$({validationSchema:z({account:g().required("帳號或電子郵件是必填的"),password:g().required("密碼是必填的").min(4,"密碼至少需要 4 個字元").max(20,"密碼最多只能有 20 個字元")})}),s=p("account"),r=p("password"),b=_.handleSubmit(async n=>{u.value=!0;try{const{data:a}=await x.login({account:n.account,password:n.password});f.login(a.user),d.notify({color:"green-4",textColor:"white",icon:"cloud_done",message:"登入成功"}),v.push("/")}catch(a){console.error(a);const l=a?.response?.data?.message||"登入失敗，請檢查帳號密碼";d.notify({color:"red-5",textColor:"white",icon:"warning",message:l})}finally{u.value=!1}});return(n,a)=>(Q(),h(C,{class:"flex flex-center"},{default:c(()=>[t("div",k,[t("div",F,[t("div",U,[o(q,{class:"q-pa-lg"},{default:c(()=>[o(V,null,{default:c(()=>[a[3]||(a[3]=t("div",{class:"text-h4 text-center q-mb-md"},"登入",-1)),o(S,{onSubmit:e(b),class:"q-col-gutter-lg"},{default:c(()=>[o(i,{filled:"",modelValue:e(s).value.value,"onUpdate:modelValue":a[0]||(a[0]=l=>e(s).value.value=l),label:"帳號或電子郵件","lazy-rules":"",rules:e(s).errorMessage.value?[e(s).errorMessage.value]:[],error:!!e(s).errorMessage.value,"error-message":e(s).errorMessage.value,type:"text",autocomplete:"username"},null,8,["modelValue","rules","error","error-message"]),o(i,{filled:"",modelValue:e(r).value.value,"onUpdate:modelValue":a[1]||(a[1]=l=>e(r).value.value=l),label:"密碼","lazy-rules":"",rules:e(r).errorMessage.value?[e(r).errorMessage.value]:[],error:!!e(r).errorMessage.value,"error-message":e(r).errorMessage.value,type:"password",autocomplete:"current-password"},null,8,["modelValue","rules","error","error-message"]),t("div",L,[o(m,{label:"登入",type:"submit",color:"primary",class:"full-width",loading:u.value,disable:!!e(s).errorMessage.value||!!e(r).errorMessage.value||u.value,size:"md"},null,8,["loading","disable"])]),t("div",N,[o(m,{flat:"",label:"還沒有帳號？註冊",color:"secondary",onClick:a[2]||(a[2]=l=>n.$router.push("/register")),size:"md"})])]),_:1},8,["onSubmit"])]),_:1,__:[3]})]),_:1})])])])]),_:1}))}};export{E as default};
